<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A+ KEY FORGE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #000; color: #ffeb3b; font-family: 'Courier New', monospace; padding: 40px; }
        .forge-box { border: 2px solid #333; padding: 30px; max-width: 600px; margin: 0 auto; background: #111; }
        input, select { background: #000; border: 1px solid #333; color: white; padding: 10px; width: 100%; margin-bottom: 15px; }
        button { background: #ffeb3b; color: black; font-weight: bold; padding: 10px 20px; border: none; cursor: pointer; width: 100%; }
        button:hover { background: #fff; }
        .key-display { background: #050505; border: 1px dashed #444; padding: 15px; margin-top: 20px; word-break: break-all; display: none; }
    </style>
</head>
<body>
    <div class="text-center mb-8">
        <h1 class="text-4xl font-bold mb-2"><i class="fas fa-hammer"></i> KEY FORGE</h1>
        <p class="text-gray-500 text-sm">INTERNAL MINTING PRESS</p>
    </div>

    <div class="forge-box">
        <label class="text-xs text-gray-500 uppercase">Master Authorization (Your Key)</label>
        <input type="password" id="adminToken" placeholder="Paste your sk_chaos_... key here">

        <label class="text-xs text-gray-500 uppercase">Key Owner Name (e.g., "Tech: Miguel")</label>
        <input type="text" id="clientName" placeholder="Name of user">

        <label class="text-xs text-gray-500 uppercase">Access Level</label>
        <select id="keyScope">
            <option value="staff">üîß STAFF (Restricted - Verify/Log Only)</option>
            <option value="full-access">üëë ADMIN (Full Control)</option>
            <option value="sandbox">üõ°Ô∏è SANDBOX (Rate Limited)</option>
        </select>

        <button onclick="mintKey()">MINT NEW KEY</button>

        <div id="result" class="key-display">
            <div class="text-xs text-gray-500 mb-1">NEW KEY GENERATED:</div>
            <div id="newKey" class="text-green-400 text-lg"></div>
        </div>
    </div>

    <div class="text-center mt-8">
        <a href="/dashboard" class="text-xs text-gray-600 hover:text-white">[ RETURN TO DASHBOARD ]</a>
    </div>

    <script>
        async function mintKey() {
            const token = document.getElementById('adminToken').value;
            const client = document.getElementById('clientName').value;
            const scope = document.getElementById('keyScope').value;

            if(!token || !client) return alert("Fill in all fields.");

            const res = await fetch('/api/admin/keys/create', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ token, clientName: client, scope })
            });

            const data = await res.json();
            if(data.success) {
                document.getElementById('result').style.display = 'block';
                document.getElementById('newKey').innerText = data.key;
            } else {
                alert("Minting Failed: " + (data.error || "Unknown Error"));
            }
        }
    </script>
</body>
</html>
