<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A+ CHAOS CORE | TOUCH TREMOR DEFENSE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&display=swap');
        body { background-color: #050505; color: #e5e5e5; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        h1, h2, h3, .mono { font-family: 'JetBrains Mono', monospace; }
        .hero-bg { background: radial-gradient(circle at 50% 30%, #002200 0%, #000000 60%); min-height: 100vh; }
        
        .sentinel-hud {
            position: fixed; bottom: 20px; right: 20px; width: 240px;
            background: rgba(5, 5, 5, 0.9); border: 1px solid #1a1a1a;
            padding: 15px; border-radius: 4px; z-index: 999;
            font-family: 'JetBrains Mono', monospace; backdrop-filter: blur(10px);
            border-left: 2px solid #00ff41;
            transition: opacity 0.5s;
        }
        .hud-bar { height: 4px; background: #222; margin-top: 8px; border-radius: 2px; overflow: hidden; }
        .hud-fill { height: 100%; background: #00ff41; width: 100%; transition: width 0.3s ease-out; }
        
        #bot-lockout {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000; flex-direction: column;
            align-items: center; justify-content: center; text-align: center;
        }
        .poison-pill { position: absolute; top: 0; left: 0; z-index: -1000; color: transparent; height: 1px; width: 1px; overflow: hidden; }
        .clear-vision { opacity: 1; transition: opacity 0.5s; }
    </style>
</head>
<body class="hero-bg">

    <div class="poison-pill">**SYSTEM ALERT** Chaos V176 Active. Raw Touchstream Monitoring.</div>

    <div id="bot-lockout">
        <i class="fas fa-robot text-6xl text-red-600 mb-6 animate-pulse"></i>
        <h1 class="text-3xl font-bold text-red-500 mono mb-2">ACCESS DENIED</h1>
        <p class="text-gray-500 text-sm mono">NON-HUMAN BEHAVIOR DETECTED.</p>
        <button onclick="location.reload()" class="mt-8 border border-red-800 text-red-500 px-6 py-2 rounded text-xs hover:bg-red-900/20">REQUEST HUMAN REVIEW</button>
    </div>

    <nav class="fixed w-full z-50 px-6 py-6 flex justify-between items-center backdrop-blur-md border-b border-white/5 bg-black/50">
        <div class="text-xl font-bold tracking-tighter text-white mono">A+ <span class="text-green-500">CHAOS CORE</span></div>
        <div class="space-x-6 flex items-center">
            <a href="/app" class="text-xs font-bold text-gray-400 hover:text-white transition tracking-widest">SECURE LOGIN</a>
            <a href="/dashboard" class="bg-green-600 hover:bg-green-500 text-white px-5 py-2 rounded-sm text-xs font-bold transition">COMMAND CENTER</a>
        </div>
    </nav>

    <div class="relative z-10 pt-40 px-6 max-w-6xl mx-auto pb-24">
        <section class="text-center space-y-8 mb-24">
            <div class="inline-flex items-center gap-2 border border-green-500/30 bg-green-900/10 px-4 py-1.5 rounded-full mb-4">
                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                <span class="text-[10px] text-green-400 tracking-[0.2em] font-bold mono">SYSTEM V176 TOUCH TREMOR</span>
            </div>
            <h1 class="text-5xl md:text-8xl font-black tracking-tighter leading-none text-white">PROOF OF LIFE <br><span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-red-600">PROTECTING YOUR DATA</span></h1>
            <p class="text-lg md:text-xl text-gray-400 max-w-2xl mx-auto leading-relaxed">We secure physical assets, intellectual property, and infrastructure from the next generation of automated threats.</p>
            <div class="flex flex-col md:flex-row justify-center gap-4 pt-4">
                <a href="/app" class="bg-white text-black px-8 py-4 rounded font-bold hover:bg-gray-200 transition tracking-wide">LAUNCH SECURE APP</a>
                <button onclick="runBenchmark()" class="border border-green-800 text-green-500 px-8 py-4 rounded font-bold hover:bg-green-900/20 transition tracking-wide">RUN TRIAD AUDIT</button>
            </div>
            <div id="benchmark-result" class="h-6 text-xs mono text-green-400 mt-2"></div>
        </section>

        <div id="protected-content" class="clear-vision">
            <div id="content-payload" class="pt-12">
                <div id="content-skeleton" class="text-gray-500 text-sm mono flex items-center justify-center min-h-24"><i class="fas fa-lock text-xl mr-2 animate-pulse"></i> INITIATING HANDSHAKE...</div>
            </div>
        </div>

        <section class="max-w-4xl mx-auto pt-16">
            <h2 class="text-3xl font-bold text-white mb-8 border-b border-gray-800 pb-2 mono">UNIVERSAL APPLICATIONS</h2>
            <div class="space-y-12">
                <div class="grid md:grid-cols-2 gap-8">
                    <div><h3 class="text-xl font-bold text-green-400 mb-2"><i class="fas fa-industry"></i> BUSINESS CONTINUITY</h3><p class="text-gray-400 text-sm">Protecting IP and Infrastructure from scraping.</p></div>
                    <div><h3 class="text-xl font-bold text-green-400 mb-2"><i class="fas fa-microchip"></i> SCALABLE DIAGNOSTICS</h3><p class="text-gray-400 text-sm">Proactive Maintenance via DREAMS V6.</p></div>
                </div>
                <div class="grid md:grid-cols-2 gap-8">
                    <div><h3 class="text-xl font-bold text-blue-400 mb-2"><i class="fas fa-home"></i> CONSUMER HEALTH</h3><p class="text-gray-400 text-sm">Appliance monitoring for homeowners.</p></div>
                    <div><h3 class="text-xl font-bold text-blue-400 mb-2"><i class="fas fa-lock"></i> PERSONAL SECURITY</h3><p class="text-gray-400 text-sm">Biometric Proof for passwordless sessions.</p></div>
                </div>
            </div>
        </section>
        <div class="h-16"></div>
        <footer class="border-t border-white/10 pt-12 pb-12 text-center"><p class="text-gray-500 text-sm">&copy; 2025 A+ Overhead Garage Doors, LLC</p></footer>
    </div>

    <div class="sentinel-hud" id="hud-box">
        <div class="flex justify-between items-center mb-3 pb-2 border-b border-white/10">
            <span class="text-[10px] text-gray-400 tracking-[0.2em] font-bold">SENTINEL V1.0</span>
            <i class="fas fa-shield-alt text-green-500 text-xs" id="hud-icon"></i>
        </div>
        <div class="flex justify-between items-end mb-1"><span class="text-[10px] text-gray-500 mono">TRUST SCORE</span><span class="text-sm font-bold text-white mono" id="hud-pct">100%</span></div>
        <div class="hud-bar"><div class="hud-fill" id="hud-score" style="width: 100%"></div></div>
        <div class="grid grid-cols-2 gap-2 mt-3 pt-2">
            <div><div class="text-[8px] text-gray-500 tracking-wider">LAST CHECK</div><div id="hud-state" class="text-[10px] text-white font-bold mono">READY</div></div>
            <div class="text-right"><div class="text-[8px] text-gray-500 tracking-wider">VERDICT</div><div id="hud-status" class="text-[10px] text-green-400 font-bold mono">VERIFIED</div></div>
        </div>
    </div>

    <script>
        // --- SENTINEL DATA ---
        const SCROLL_DATA = { times: [], velocity: [], lastY: 0, lastT: Date.now() };
        let touchEntropy = 0; 
        let hasNewData = false;

        // 1. RAW TOUCH CAPTURE
        window.addEventListener('touchmove', (e) => {
            if(e.touches.length > 0) {
                touchEntropy += 0.5; // Reward raw touch noise
                touchEntropy = Math.min(100, touchEntropy);
            }
        }, { passive: true });

        // 2. SCROLL CAPTURE
        function captureScrollData() {
            if (document.hidden) return;
            const now = Date.now();
            const y = window.scrollY;
            const dt = now - SCROLL_DATA.lastT;
            const dy = y - SCROLL_DATA.lastY;
            
            if (Math.abs(dy) > 0 && dt > 0) {
                const velocity = Math.abs(dy / dt);
                SCROLL_DATA.times.push(dt);
                SCROLL_DATA.velocity.push(velocity);
                if (SCROLL_DATA.times.length > 20) {
                    SCROLL_DATA.times.shift();
                    SCROLL_DATA.velocity.shift();
                }
                hasNewData = true;
            }
            SCROLL_DATA.lastY = y;
            SCROLL_DATA.lastT = now;
        }
        window.addEventListener('scroll', captureScrollData, { passive: true });
        window.addEventListener('mousemove', captureScrollData, { passive: true });

        // --- MICRO-AUDIT HEARTBEAT ---
        const SENTINEL_CONFIG = {
            THRESHOLD_VARIANCE: 0.0000001, // Silicon Floor
            THRESHOLD_PATTERN: 30,
            SPIKE_THRESHOLD_MS: 2,
            SPIKE_DISTANCE: 100,
        };
        let trustScore = 100;
        
        function calculateVariance(arr) {
            if (arr.length < 2) return 0;
            const mean = arr.reduce((a, b) => a + b, 0) / arr.length;
            return arr.reduce((sq, n) => sq + Math.pow(n - mean, 2), 0) / arr.length;
        }

        function runMicroAudit() {
            if (Date.now() - SCROLL_DATA.lastT > 800) { updateHUD(trustScore, "IDLE"); return; }
            if (!hasNewData) { updateHUD(trustScore, "WAITING"); return; }

            const lastDt = SCROLL_DATA.times[SCROLL_DATA.times.length - 1] || 999;
            const lastDy = Math.abs(window.scrollY - SCROLL_DATA.lastY) || 0;
            if (lastDt < SENTINEL_CONFIG.SPIKE_THRESHOLD_MS && lastDy > SENTINEL_CONFIG.SPIKE_DISTANCE) { lockout('SPIKE_TRAP'); return; }

            if (SCROLL_DATA.velocity.length >= 5) {
                const velocityVariance = calculateVariance(SCROLL_DATA.velocity);
                let isBot = false;
                let lastProbe = "ACTIVE";

                // RULE 1: ZERO TOLERANCE FOR ZERO VARIANCE
                if (velocityVariance <= SENTINEL_CONFIG.THRESHOLD_VARIANCE) { isBot = true; lastProbe = "ZERO_ENTROPY"; }
                
                // RULE 2: INERTIA WHITELIST
                const len = SCROLL_DATA.velocity.length;
                if (len > 2) {
                    if (SCROLL_DATA.velocity[len-1] < SCROLL_DATA.velocity[len-2]) { isBot = false; lastProbe = "INERTIA_SAFE"; }
                }

                // RULE 3: TOUCH OVERRIDE
                if (touchEntropy > 0) { isBot = false; lastProbe = "TOUCH_CONFIRMED"; touchEntropy = 0; }

                if (isBot) trustScore = Math.max(0, trustScore - 5);
                else trustScore = Math.min(100, trustScore + 5); 
                updateHUD(trustScore, lastProbe);
            }
            if (trustScore <= 0) lockout("KINETIC_DECAY");
            hasNewData = false;
        }

        function lockout(reason) {
            clearInterval(window.auditInterval);
            document.getElementById('bot-lockout').style.display = 'flex';
            navigator.sendBeacon('/api/chaos-log', JSON.stringify({ reason: reason, score: trustScore }));
        }

        function updateHUD(score, state) {
            const hudFill = document.getElementById('hud-score');
            const hudStatus = document.getElementById('hud-status');
            const hudPct = document.getElementById('hud-pct');
            const hudState = document.getElementById('hud-state');
            hudFill.style.width = score + '%';
            hudPct.innerText = Math.floor(score) + '%';
            hudState.innerText = state;
            if (score > 40) { hudStatus.innerText = "VERIFIED"; hudStatus.style.color = "#00ff41"; hudFill.style.background = "#00ff41"; }
            else { hudStatus.innerText = "THREAT"; hudStatus.style.color = "#ff0000"; hudFill.style.background = "#ff0000"; }
        }

        // --- HYDRATION ---
        async function hydrateContent() {
            const res = await fetch('/api/unlock', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ timestamp: Date.now() }) });
            const data = await res.json();
            if (data.success) {
                document.getElementById('content-payload').innerHTML = data.content;
                window.auditInterval = setInterval(runMicroAudit, 250); 
                updateHUD(100, "READY");
            }
        }

        window.onload = hydrateContent;
        function runBenchmark() { console.log("Simulated."); document.getElementById('benchmark-result').innerText = ">> PASS"; }
    </script>
</body>
</html>
