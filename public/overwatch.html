<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>A+ OVERWATCH | TELEMETRY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: #050505; color: #00ff41; font-family: monospace; }
        .grid-bg { background-image: radial-gradient(#003300 1px, transparent 1px); background-size: 20px 20px; }
        .log-entry { border-left: 2px solid #00ff41; padding-left: 10px; margin-bottom: 5px; opacity: 0; animation: fadein 0.3s forwards; }
        @keyframes fadein { to { opacity: 1; } }
    </style>
</head>
<body class="h-screen w-screen grid-bg overflow-hidden flex flex-col p-4">

    <div class="flex justify-between items-center border-b border-green-900 pb-4 mb-4">
        <h1 class="text-2xl font-bold tracking-widest"><i class="fas fa-satellite-dish animate-pulse"></i> OVERWATCH V148</h1>
        <div class="text-xs text-green-600">STATUS: <span class="text-green-400">ONLINE</span></div>
    </div>

    <div class="flex-1 flex gap-4">
        
        <div class="w-1/3 space-y-4">
            <div class="bg-black border border-green-800 p-4 rounded">
                <div class="text-gray-500 text-xs">TOTAL REQUESTS</div>
                <div id="req-count" class="text-4xl font-bold">0</div>
            </div>
            <div class="bg-black border border-red-900 p-4 rounded">
                <div class="text-gray-500 text-xs">THREATS BLOCKED</div>
                <div id="block-count" class="text-4xl font-bold text-red-500">0</div>
            </div>
            <div class="bg-black border border-green-800 p-4 rounded h-64 overflow-hidden relative">
                <div class="text-gray-500 text-xs mb-2">LIVE LOGS</div>
                <div id="log-feed" class="text-xs space-y-2 h-full overflow-y-auto pb-8">
                    </div>
            </div>
        </div>

        <div class="w-2/3 bg-black border border-green-800 rounded relative overflow-hidden flex items-center justify-center">
            <div class="absolute inset-0 opacity-20 animate-pulse bg-gradient-to-t from-green-900 to-transparent"></div>
            <div class="text-center">
                <i class="fas fa-globe-americas text-6xl text-green-900 mb-4"></i>
                <p class="text-xs text-green-700">GLOBAL THREAT MAP ACTIVE</p>
                <p class="text-[10px] text-green-900 mt-2">WAITING FOR GEODATA...</p>
            </div>
        </div>
    </div>

    <script>
        // Connect to Live Wire (SSE)
        const eventSource = new EventSource('/api/v1/stream');
        
        const logFeed = document.getElementById('log-feed');
        const reqCount = document.getElementById('req-count');
        const blockCount = document.getElementById('block-count');

        eventSource.onmessage = function(e) {
            // Keep alive pings
        };

        eventSource.addEventListener('log', function(e) {
            const data = JSON.parse(e.data);
            
            // Update Stats
            if(data.stats) {
                reqCount.innerText = data.stats.requests;
                blockCount.innerText = data.stats.threats;
            }

            // Add Log
            if(data.entry) {
                const div = document.createElement('div');
                div.className = 'log-entry';
                div.innerText = data.entry;
                logFeed.prepend(div);
                if(logFeed.children.length > 20) logFeed.lastChild.remove();
            }
        });

        // Initial Fetch
        fetch('/api/v1/admin/telemetry').then(r=>r.json()).then(d => {
            reqCount.innerText = d.stats.requests;
            blockCount.innerText = d.stats.threats;
            d.logs.forEach(l => {
                const div = document.createElement('div');
                div.className = 'log-entry';
                div.innerText = l;
                logFeed.appendChild(div);
            });
        });
    </script>
</body>
</html>
