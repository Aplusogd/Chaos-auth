<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chaos Terminal | Overthere.ai</title>
    <link rel="stylesheet" href="css/modern.css">
</head>
<body>
    <div class="terminal-grid">
        <aside class="column">
            <h2 style="color:var(--neon-mint); margin-bottom:30px;">[ CHAOS_ID ]</h2>
            
            <div class="stats-box">
                <div class="label">Identity</div>
                <div class="value" id="dispCallsign">---</div>
            </div>
            
            <div class="stats-box">
                <div class="label">Trust Level</div>
                <div class="value" id="dispTrust">50%</div>
            </div>

            <nav style="margin-top:40px;">
                <button class="cmd-btn" onclick="execute('VOTE')">>> EXECUTE_VOTE</button>
                <button class="cmd-btn" onclick="execute('AUTH')">>> EXECUTE_AUTH</button>
                <button class="cmd-btn" onclick="showVault()">>> ACCESS_VAULT</button>
            </nav>
            
            <div id="eagleConsole" style="display:none; margin-top:30px;">
                <div class="label" style="color:var(--blood-red)">Master Override</div>
                <button class="cmd-btn eagle-mode" onclick="globalPurge()">>> PURGE_NETWORK</button>
            </div>
        </aside>

        <main class="column" style="background:#050505;">
            <div id="terminalFeed" class="feed">
                <div class="feed-line"><span class="feed-time">[00:00:00]</span> SYSTEM_INITIALIZED...</div>
            </div>
            
            <div class="card" id="inputArea">
                <div class="label">Active Payload</div>
                <input type="text" id="payload" placeholder="Enter encrypted note..." style="background:#000; color:var(--neon-mint); border:1px solid #222; width:100%; padding:10px; margin-top:5px;">
            </div>
        </main>

        <aside class="column">
            <h4 style="color:var(--slate); margin-bottom:20px;">// THE_ABYSS</h4>
            <div id="vaultContent" style="font-size:0.75rem; color:#888;">
                Vault is currently sealed.
            </div>
        </aside>
    </div>

    <script src="js/chaos-core.js"></script>
    <script>
        const myName = localStorage.getItem('CHAOS_CALLSIGN');
        if(!myName) window.location.href = '/';

        const chaos = new ChaosID(myName);
        const feed = document.getElementById('terminalFeed');

        function log(msg, color = "#d0d0d0") {
            const time = new Date().toLocaleTimeString();
            const line = document.createElement('div');
            line.className = 'feed-line';
            line.innerHTML = `<span class="feed-time">[${time}]</span> <span style="color:${color}">${msg}</span>`;
            feed.appendChild(line);
            feed.scrollTop = feed.scrollHeight;
        }

        // Setup UI
        document.getElementById('dispCallsign').innerText = chaos.callsign;
        document.getElementById('dispTrust').innerText = chaos.trust + "%";

        if(chaos.isAdmin) {
            document.getElementById('eagleConsole').style.display = 'block';
            log("ðŸ¦… MASTER ACCESS DETECTED. EAGLE_OVERSIGHT ACTIVE.", "#ff4444");
        } else {
            log("USER_SESSION STARTED. Welcome back, " + chaos.callsign);
        }

        async function execute(action) {
            const payload = document.getElementById('payload').value;
            log("INITIATING " + action + " PROTOCOL...");
            const token = await chaos.generateProof(action, payload);
            log("SUCCESS: " + token, "#00ff9d");
            document.getElementById('dispTrust').innerText = chaos.trust + "%";
            showVault();
        }

        function showVault() {
            const v = document.getElementById('vaultContent');
            const data = JSON.parse(localStorage.getItem('ABYSS_VAULT')) || [];
            v.innerHTML = data.map(i => `<div style="margin-bottom:10px; border-bottom:1px solid #111;">> ${i.i}</div>`).reverse().join('');
        }

        function globalPurge() {
            if(confirm("MASTER: CLEAR ALL REPUTATION?")) {
                localStorage.clear();
                window.location.reload();
            }
        }

        showVault();
    </script>
</body>
</html>
