<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Control Center | Chaos ID</title>
    <link rel="stylesheet" href="css/modern.css">
    <script src="js/chaos-universal.js"></script>
    <style>
        .admin-only { display: none; border: 2px solid #ef4444 !important; }
        .user-stats { background: #fff; padding: 20px; border-radius: 12px; border: 1px solid #e2e8f0; margin-bottom: 20px; }
        .score-bar { height: 10px; background: #e2e8f0; border-radius: 5px; overflow: hidden; margin: 10px 0; }
        .score-fill { height: 100%; background: #2563eb; transition: width 0.5s; }
        .badge { font-size: 0.7rem; padding: 4px 8px; border-radius: 4px; text-transform: uppercase; margin-left: 10px; }
        .badge-admin { background: #fee2e2; color: #b91c1c; }
        .badge-user { background: #dcfce7; color: #15803d; }
    </style>
</head>
<body style="background: #f8fafc;">
    <nav class="navbar" style="background: white; border-bottom: 1px solid #e2e8f0;">
        <a href="/" class="logo">Chaos<span>ID</span></a>
        <div>
            <span id="badgeIcon" class="badge">---</span>
            <span id="displayCallsign" style="font-weight: 700;">---</span>
        </div>
    </nav>

    <div class="dashboard-grid" style="padding: 40px 5%;">
        <div class="user-stats">
            <h3>Identity Reputation</h3>
            <p style="font-size: 0.9rem; color: #64748b;">Proof of Action Rewards Score</p>
            <div class="score-bar"><div id="scoreFill" class="score-fill"></div></div>
            <div style="display: flex; justify-content: space-between; font-weight: bold;">
                <span>Trust Score: <span id="scoreText">0</span>%</span>
                <span id="rewardStatus" style="color: #2563eb;">RANK: NOVICE</span>
            </div>
        </div>

        <div class="card" style="background: white;">
            <h3>Verification Tools</h3>
            <div id="tokenOutput" class="token-box" style="background: #0f172a; color: #10b981; padding: 15px; border-radius: 8px; font-family: monospace; margin: 15px 0;">READY</div>
            <button onclick="handleAction('VOTE')" style="background: #2563eb; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600;">GENERATE VOTE</button>
        </div>

        <div id="adminPanel" class="card admin-only" style="background: white;">
            <h3 style="color: #b91c1c;">ðŸ”´ MASTER COMMANDS</h3>
            <p>Global System Oversight & Trust Overrides</p>
            <button onclick="alert('Global Reset Protocol Ready')" style="background: #ef4444; color: white; border: none; padding: 10px 20px; border-radius: 6px; margin-top: 15px; cursor: pointer;">RESET ALL TRUST SCORES</button>
        </div>
    </div>

    <script>
        const callsign = localStorage.getItem('CHAOS_CALLSIGN');
        if(!callsign) window.location.href = '/';

        const engine = new ChaosEngine(callsign);
        
        // Setup UI
        document.getElementById('displayCallsign').innerText = engine.callsign;
        const badge = document.getElementById('badgeIcon');
        
        if(engine.isAdmin) {
            badge.innerText = "MASTER";
            badge.className = "badge badge-admin";
            document.getElementById('adminPanel').style.display = "block";
            document.getElementById('rewardStatus').innerText = "SYSTEM OWNER";
        } else {
            badge.innerText = "VERIFIED USER";
            badge.className = "badge badge-user";
        }

        function updateUI() {
            const score = engine.trustScore;
            document.getElementById('scoreText').innerText = score;
            document.getElementById('scoreFill').style.width = score + "%";
            
            if(!engine.isAdmin) {
                let rank = "NOVICE";
                if(score > 70) rank = "TRUSTED OPERATOR";
                if(score > 90) rank = "CHAOS VETERAN";
                document.getElementById('rewardStatus').innerText = "RANK: " + rank;
            }
        }

        function handleAction(type) {
            const token = engine.generateProof(type);
            document.getElementById('tokenOutput').innerText = token;
            updateUI();
        }

        updateUI();
    </script>
</body>
</html>
